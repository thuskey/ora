#!/bin/sh

set -e

. /usr/share/debconf/confmodule

db_version 2.0
#db_capb backup

PREVSTATE=1
STATE=1
while [ "$STATE" != "0" ]; do

	case "$STATE" in
		1) # install now or later?
			db_input high quake3-data/install || true
			NEXTSTATE=2
			PREVSTATE=0
			;;
		2) # select cdrom path
			db_get quake3-data/install
			if [ "$RET" = "false" ]; then
				exit 0
			fi
			db_input high quake3-data/cdrom || true
			NEXTSTATE=3
			PREVSTATE=1
			;;
		3) # select mirror
			db_input high quake3-data/mirror || true
			NEXTSTATE=0
			PREVSTATE=2
			;;
	esac

	# debconf is GO!
	if db_go; then
		STATE=$NEXTSTATE
	else
		STATE=$PREVSTATE
	fi

done
